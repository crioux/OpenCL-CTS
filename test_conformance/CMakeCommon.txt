string(TOLOWER ${MODULE_NAME} MODULE_NAME_LOWER)

set(${MODULE_NAME}_OUT ${CONFORMANCE_PREFIX}${MODULE_NAME_LOWER}${CONFORMANCE_SUFFIX})

#add_executable(${${MODULE_NAME}_OUT} ${${MODULE_NAME}_SOURCES})

# ---
add_library(${${MODULE_NAME}_OUT} SHARED ${${MODULE_NAME}_SOURCES})
set_property(TARGET ${${MODULE_NAME}_OUT} PROPERTY WINDOWS_EXPORT_ALL_SYMBOLS YES)
LIST(APPEND CONFORMANCE_TEST_TARGETS ${${MODULE_NAME}_OUT})
set(CONFORMANCE_TEST_TARGETS ${CONFORMANCE_TEST_TARGETS} PARENT_SCOPE)
FOREACH(source ${${MODULE_NAME}_SOURCES})
  IF(MSVC)
    SET_PROPERTY(SOURCE ${source} APPEND_STRING PROPERTY COMPILE_FLAGS " /FI\"dllio.h\" ")
  ELSE()
    SET_PROPERTY(SOURCE ${source} APPEND_STRING PROPERTY COMPILE_FLAGS " -include \"dllio.h\" ")
  ENDIF()
ENDFOREACH()
# ---

set_property(TARGET ${${MODULE_NAME}_OUT} PROPERTY FOLDER "CONFORMANCE${CONFORMANCE_SUFFIX}")

TARGET_LINK_LIBRARIES(${${MODULE_NAME}_OUT} ${HARNESS_LIB} ${CLConform_LIBRARIES})
